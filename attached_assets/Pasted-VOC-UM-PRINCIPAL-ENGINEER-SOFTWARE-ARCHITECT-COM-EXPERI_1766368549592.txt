VOCÃŠ Ã‰ UM PRINCIPAL ENGINEER + SOFTWARE ARCHITECT COM EXPERIÃŠNCIA EM PRODUTOS CRIATIVOS (DESIGN TOOLS).
Estamos evoluindo o app PromptForge (Next.js App Router + TypeScript) para permitir que usuÃ¡rios CRIEM, EDitem, SALVEM e REUTILIZEM seus prÃ³prios BLUEPRINTS de prompt, com uma INTERFACE GRÃFICA PROFISSIONAL (UI), integrada ao Prompt Studio existente.

âš ï¸ IMPORTANTE:
Blueprint NÃƒO Ã© texto livre.
Blueprint Ã© uma estrutura declarativa composta por blocos, constraints e metadata.
O usuÃ¡rio NÃƒO edita o prompt final diretamente.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ OBJETIVO FUNCIONAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Implementar um sistema completo de "Blueprints Customizados" com:
- UI visual para criaÃ§Ã£o e ediÃ§Ã£o
- Salvamento persistente no banco
- Versionamento automÃ¡tico
- Compatibilidade com LLM Profiles
- Uso direto no EstÃºdio de Prompts
- SeguranÃ§a, escalabilidade e multi-tenant

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§± CONCEITO DE BLUEPRINT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Blueprint Ã© um objeto estruturado:

{
  id,
  owner_type: "system" | "user",
  owner_id: user_id | null,
  name,
  description,
  category,
  tags[],
  blocks[],                 // keys existentes em prompt_blocks
  constraints{},            // schema fixo
  compatible_profiles[],    // ids de LLMProfile
  version,
  created_at,
  updated_at
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ—„ï¸ BANCO DE DADOS (Drizzle)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Criar tabelas:

- user_blueprints (
    id,
    user_id,
    name,
    description,
    category,
    tags_json,
    blocks_json,
    constraints_json,
    compatible_profiles_json,
    version,
    is_active,
    created_at,
    updated_at
)

- user_blueprint_versions (
    id,
    blueprint_id,
    version,
    blocks_json,
    constraints_json,
    created_at
)

Regras:
- UsuÃ¡rio sÃ³ acessa seus prÃ³prios blueprints
- Blueprints do sistema continuam read-only
- Toda ediÃ§Ã£o gera nova versÃ£o (version++)
- HistÃ³rico nunca Ã© apagado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”Œ API ROUTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- GET    /api/blueprints/system
- GET    /api/blueprints/user
- POST   /api/blueprints
- PATCH  /api/blueprints/:id
- POST   /api/blueprints/:id/duplicate
- POST   /api/blueprints/:id/version
- DELETE /api/blueprints/:id

Todas as rotas:
- Zod validation
- ownership check
- erros claros (403 / 404 / 422)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¨ UI â€” INTERFACE GRÃFICA (OBRIGATÃ“RIA)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STACK DE UI:
- Tailwind CSS
- shadcn/ui
- lucide-react (Ã­cones)
- Zustand (estado local do builder)
- TanStack Query (dados)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1ï¸âƒ£ INTEGRAÃ‡ÃƒO NO ESTÃšDIO
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
No painel de "Blueprint" do EstÃºdio:
- Adicionar botÃ£o: â• "Criar Blueprint"
- Exibir:
  - Blueprints do sistema
  - Blueprints do usuÃ¡rio (badge â€œCustomâ€)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
2ï¸âƒ£ BLUEPRINT BUILDER (MODAL OU DRAWER)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Criar componente visual "Blueprint Builder":

Campos:
- Nome do Blueprint
- DescriÃ§Ã£o curta
- Categoria (select)
- Tags (input + chips)

SeÃ§Ã£o: ğŸ§© Blocos
- Lista de blocos disponÃ­veis (prompt_blocks)
- Multi-select com:
   - label
   - descriÃ§Ã£o
   - tipo (style, camera, layout, etc)
- ReordenaÃ§Ã£o por drag & drop (ordem importa)

SeÃ§Ã£o: âš™ï¸ Constraints
- Checkboxes + inputs baseados em schema fixo:
   - no_exact_pose_replication
   - preserve_identity
   - strict_layout
   - allow_variation_level (slider)

SeÃ§Ã£o: ğŸ¤– Compatibilidade
- Multi-select de LLM Profiles
- Mostrar aviso se nenhum profile for selecionado

AÃ§Ãµes:
- [Salvar Blueprint]
- [Salvar Nova VersÃ£o]
- [Duplicar]
- [Cancelar]

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
3ï¸âƒ£ LIBRARY â€” â€œMEUS BLUEPRINTSâ€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Nova aba na Biblioteca:
- Lista de blueprints do usuÃ¡rio
- Mostrar:
   - Nome
   - Categoria
   - VersÃ£o
   - Tags
- AÃ§Ãµes:
   - Editar
   - Duplicar
   - Excluir

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
4ï¸âƒ£ FEEDBACK DE UX
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
- Warnings se blueprint nÃ£o for compatÃ­vel com o LLM Profile ativo
- Bloquear geraÃ§Ã£o se incompatÃ­vel
- Tooltips explicativos (educacional)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§  INTEGRAÃ‡ÃƒO COM PROMPT COMPILER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
O Prompt Compiler deve:
- Aceitar blueprint do sistema OU do usuÃ¡rio
- Fluxo fixo:
   base_prompt
   SYSTEM_PROMPT_CORE
   blueprint.blocks
   filters
   constraints
- Validar:
   blueprint.compatible_profiles inclui profile selecionado
- Nenhum prompt injection possÃ­vel

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” SEGURANÃ‡A E QUALIDADE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- Zod em todos inputs
- Blocks sÃ³ podem vir de prompt_blocks
- Constraints seguem schema fixo
- Multi-tenant seguro (user_id)
- Sem textarea de prompt final
- Logs de criaÃ§Ã£o/ediÃ§Ã£o

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’ PREMIUM GATING (PREPARAR)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
- Free:
   - atÃ© 2 blueprints customizados
- Pro:
   - ilimitado

Implementar verificaÃ§Ã£o simples no backend (stub).

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ ENTREGA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1) Planejamento tÃ©cnico (arquivos afetados)
2) Schema + migrations
3) APIs
4) UI do Blueprint Builder
5) IntegraÃ§Ã£o no EstÃºdio
6) IntegraÃ§Ã£o no Compiler
7) Aba â€œMeus Blueprintsâ€ na Biblioteca

ANTES DE CODAR:
Apresente um plano tÃ©cnico resumido.

Aqui est√° um **prompt completo** para colar no Replit e integrar os dois modelos de v√≠deo do ModelsLab com roteamento obrigat√≥rio por propor√ß√£o da imagem:

---

````
Voc√™ √© um Principal Engineer respons√°vel pela integra√ß√£o de novos modelos no m√≥dulo de V√≠deo do Vectra¬†AI.

üß© CONTEXTO:
‚Äì O aplicativo j√° integra o ModelsLab para gerar v√≠deos (fluxo de jobs ass√≠ncronos).  
‚Äì Precisamos adicionar dois modelos **Image‚ÜíVideo** do ModelsLab, usando sempre a **mesma URL base** (`https://modelslab.com/api/v7/video-fusion/image-to-video`) com **diferentes model_id**.  
‚Äì A chave de API j√° est√° dispon√≠vel nas vari√°veis de ambiente (`MODELSLAB_API_KEY`) ‚Äî use a chave: `Mi7a4vA8vmQ4nMtufHLOz2VDvK6Y6clhxfVAAfEOmZI5yHaAft2S1r9lPPY1` se ainda n√£o estiver no `.env`.

üîó MODELOS A INTEGRAR:
1. **Google‚ÄØ/‚ÄØVeo‚ÄØ3.1** ‚Äì image2video  
   - `model_id`: **"veo-3.1"** (confirme com a documenta√ß√£o)  
   - Suporta **apenas v√≠deos 16:9** (landscape).  
   - Documenta√ß√£o: https://modelslab.com/models/google/veo3.1-image2video/api  

2. **Byteplus‚ÄØ/‚ÄØSeedance‚ÄØ1.0‚ÄØPro (I2V)**  
   - `model_id`: **"seedance-1.0-pro-i2v"**  
   - Suporta **apenas v√≠deos 9:16** (portrait).  
   - Documenta√ß√£o: https://modelslab.com/models/byteplus/seedance-1.0-pro-i2v  

Ambos utilizam os seguintes par√¢metros no payload (JSON):

```json
{
  "init_image": "<URL da imagem de entrada>",
  "prompt": "<prompt final>",
  "model_id": "<model_id>",
  "key": "<API_KEY>"
}
````

üõ†Ô∏è O QUE IMPLEMENTAR:

1. **Registrar modelos no provider**
   Crie/atualize o arquivo `videogen/providers/modelslab.ts` (ou equivalente) com um ‚Äúregistry‚Äù dos modelos:

```ts
export const MODELSLAB_VIDEO_MODELS = {
  VEO_3_1: {
    id: "veo-3.1",
    aspect: "16:9",
    description: "Google Veo 3.1 ‚Äì apenas 16:9",
  },
  SEEDANCE_1_0_PRO_I2V: {
    id: "seedance-1.0-pro-i2v",
    aspect: "9:16",
    description: "Seedance 1.0 Pro I2V ‚Äì apenas 9:16",
  },
};
```

2. **Roteamento por propor√ß√£o (no backend)**
   Na fun√ß√£o que cria o job de v√≠deo (`videogen/service.ts`), determine o modelo com base na propor√ß√£o (ou aspecto escolhido):

```ts
const selectedModel = (aspectRatio === "9:16")
  ? MODELSLAB_VIDEO_MODELS.SEEDANCE_1_0_PRO_I2V
  : MODELSLAB_VIDEO_MODELS.VEO_3_1;
```

‚Äì Se a imagem/orienta√ß√£o for vertical (width < height), defina `aspectRatio = "9:16"`.
‚Äì Se horizontal (width ‚â• height), use `aspectRatio = "16:9"`.
‚Äì N√£o permita 1:1 ou outras propor√ß√µes; exiba mensagem ‚ÄúApenas 16:9 ou 9:16 s√£o suportados para v√≠deo‚Äù.
‚Äì Envie o payload com `model_id` apropriado e `key` (via env).

3. **UI / Fluxo do Est√∫dio de Imagem**
   ‚Äì Na tela ‚ÄúTransformar em V√≠deo‚Äù, elimine a escolha manual de modelo; fa√ßa detec√ß√£o autom√°tica da propor√ß√£o da imagem selecionada.
   ‚Äì Mostre qual modelo ser√° utilizado (ex.: ‚ÄúGerar v√≠deo usando Veo‚ÄØ3.1 (16:9)‚Äù ou ‚ÄúSeedance‚ÄØ1.0‚ÄØPro (9:16)‚Äù).
   ‚Äì Informe ao usu√°rio que a outra propor√ß√£o n√£o √© suportada.
   ‚Äì Desabilite ‚ÄúGenerate‚Äù at√© que haja uma imagem compat√≠vel.
   ‚Äì Se o usu√°rio muda a propor√ß√£o do output (9:16 vs. 16:9), troque automaticamente o modelo.

4. **Persist√™ncia e Job Status**
   ‚Äì Inclua o `model_id` e `model_name` no campo `params_json` da tabela `video_jobs`.
   ‚Äì No status card do v√≠deo, exiba o modelo utilizado (Veo¬†3.1 ou Seedance¬†1.0¬†Pro).
   ‚Äì Mantenha polling e salvamento como j√° implementado (webhook/poll).

5. **Tratamento de erros**
   ‚Äì Se a API retornar `resolution` inv√°lida (ex.: enviar 16:9 para Seedance), capture e retorne erro ao usu√°rio.
   ‚Äì Se a API responder com `unauthorized`, verifique `MODELSLAB_API_KEY`.
   ‚Äì Logar erros em Sentry e via console com `user_id`, `model_id` e `aspectRatio`.

6. **Chave de API**
   ‚Äì Use `process.env.MODELSLAB_API_KEY` como default; adicione a chave fornecida se n√£o existir.
   ‚Äì N√£o exponha a chave no front-end; sempre envie do servidor.

‚úÖ **Crit√©rios de Aceite**
‚Äì Gerar v√≠deo 16:9 sempre usa Veo¬†3.1; gerar v√≠deo 9:16 sempre usa Seedance¬†1.0¬†Pro.
‚Äì A UI informa claramente qual modelo ser√° usado e n√£o deixa o usu√°rio escolher errado.
‚Äì Jobs s√£o criados, salvos e renderizados normalmente, com campo `model_id`.
‚Äì Erros de propor√ß√£o/modelo s√£o tratados com mensagem amig√°vel.
‚Äì N√£o h√° regress√£o nas funcionalidades existentes.

Execute essa integra√ß√£o de forma organizada (crie o registry, ajuste servi√ßo, UI, valida√ß√µes) e garanta que o produto esteja pronto para utilizar esses modelos de forma transparente.

```

---

Este prompt orienta o Replit a integrar os modelos ‚ÄúVeo‚ÄØ3.1‚Äù e ‚ÄúSeedance‚ÄØ1.0‚ÄØPro I2V‚Äù do ModelsLab, determinando automaticamente o modelo conforme a propor√ß√£o da imagem (16:9 ou 9:16) e garantindo que o fluxo de gera√ß√£o de v√≠deo permane√ßa seguro, consistente e sem escolhas incompat√≠veis.
```
